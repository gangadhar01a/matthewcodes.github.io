
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Camel.js: An Introduction - MatthewCodes</title>
  <meta name="author" content="Matthew Wilson">

  
  <meta name="description" content="Camel.js: An Introduction written May 9th, 2015 in camel.js, javascript, node.js A routing and integration framework for node.js Apache Camel In a &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://matthewcodes.github.io/blog/2015/05/09/camel-dot-js-an-introduction">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="MatthewCodes" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-62020128-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  <link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700,900|Slabo+27px' rel='stylesheet' type='text/css'>
</head>

  <body>
    <a href="/" class="home-icon">
      <img src="/images/home.png"/>
    </a>

    <article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h1>Camel.js: An Introduction</h1>
        <div class="meta">
          written 




<time class='entry-date' datetime='2015-05-09T00:27:49+01:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'></span></time>
          

in
<span class="categories">
  
    <a class='category' href='/blog/categories/camel-dot-js/'>camel.js</a>, <a class='category' href='/blog/categories/javascript/'>javascript</a>, <a class='category' href='/blog/categories/node-dot-js/'>node.js</a>
  
</span>


        </div>
        <p>A routing and integration framework for node.js</p>

<!-- more -->


<h2>Apache Camel</h2>

<p>In a previous work project I had the privilege of using <a href="http://camel.apache.org/">Apache Camel</a> for creating an <a href="http://en.wikipedia.org/wiki/Enterprise_service_bus">ESB</a>. Camel allows developers to define routing rules using one of the provided domain-specific languages; these include java, spring and blueprint to name a few.</p>

<p>An example of the java dsl can be seen here:</p>

<pre><code>context.addRoutes(new RouteBuilder() {
  public void configure() {
      from("test-jms:queue:test.queue").to("file://test");
  }
});
</code></pre>

<p>This copies something from a queue to a file. Notice how little code was needed to do something that would take quite a number of lines if you were to do it yourself.</p>

<p>I&rsquo;m not going to praise camel any more, I do it enough times a day for people to question my sanity, but theres a famous question on <a href="http://stackoverflow.com/questions/8845186/what-exactly-is-apache-camel">StackOverflow that explains camel much better than I can.</a></p>

<h2>npm</h2>

<p>For the past few months I have been writing a lot javascript for various projects and I&rsquo;ve started to enjoy using node.js for creating server side applications. Coupled with npm (Node Package Manager), it&rsquo;s been easy to utilise different frameworks to get an application up and running in a very short space of time. We used it heavily for a recent <a href="https://github.com/matthewcodes/ping">hackathon project.</a></p>

<p>I&rsquo;ve always been a fan of package managers and have used maven in most of the java projects I&rsquo;ve worked on, I have also pretended to use nuget for C# projects as well (#insideJoke). I wanted to create and publish my own npm package that others could use in their projects, and camel.js was an idea I had been thinking about for a while.</p>

<h2>Camel.js</h2>

<p>My initial plan is to create a &lsquo;camel-like&rsquo; javascript framework that allows people to easily define routes between different endpoints.</p>

<p>My definition of &lsquo;camel-like&rsquo; is a similar DSL to Apache Camel, but using the strengths of node.js, enabling non blocking asynchronous routes. That not only route between built in node modules like <a href="https://nodejs.org/api/fs.html">fs</a>, but also integrate with popular npm packages like <a href="http://expressjs.com/">express</a>.</p>

<p>As of writing this post the current version of camel.js is 0.1.10 and can be installed from npm by running the command:</p>

<pre><code>npm install camel.js
</code></pre>

<p>The stats on the <a href="https://www.npmjs.com/package/camel.js">npm site</a> say that there have been 320 downloads in the past month! But I have my suspicions that most of these are mirrors/bots, as there have been no issues raised yet on github from anyone using the framework!</p>

<p><a href="https://nodei.co/npm/camel.js/"><img src="https://nodei.co/npm/camel.js.png?downloads=true&amp;downloadRank=true&amp;stars=true" alt="NPM" /></a></p>

<p>The current functionality is obviously very limited at this early stage, I have added support for reading and writing to files and have packaged it all up as an npm module.</p>

<p>If you wanted to create a simple file transfer application you first need to require the camel.js module, and create a camel context:</p>

<pre><code>var camel = require('camel.js');
var context = new camel.context();
</code></pre>

<p>You can then define your route and add it to the context:</p>

<pre><code>route = new camel.route();

route.from('file://source.txt')
     .to('file://result.txt');

context.addRoute(route);
</code></pre>

<p>Then start the context, which will process all routes that have been added.</p>

<pre><code>context.start();
</code></pre>

<p>You can define as many routes as you like and because we are using the asynchronous callbacks in our file read/write code, the routes themselves will also be processed asynchronously. You can also have as many endpoints defined in a single route as well like so:</p>

<pre><code>route.from('file://source.txt')
     .to('file://result1.txt');
     .to('file://result2.txt');
     .to('file://result3.txt');
     .to('file://result4.txt');
     .to('file://result5.txt');
</code></pre>

<p>This would copy the content of source.txt to all the result*.txt files.</p>

<p>Another feature that has just been added in the latest release is reading all the files from a directory, this can be done like so:</p>

<pre><code>route.from('file://sourceDirectory')
     .to('file://result.txt');
</code></pre>

<p>Although the code above is pretty pointless as it would overwrite the content of each file in sourceDirectory to result.txt. It will make more sense once I have directory support added to the <code>to</code> function and we can do this:</p>

<pre><code>route.from('file://sourceDirectory')
     .to('file://resultDirectory');
</code></pre>

<h2>Testing</h2>

<p>Once I had my prototype finished, I decided to focus on getting some tests in place so that I could switch to a test driven approach. I decided to use mocha and chai for running and defining the tests (I&rsquo;ll write a separate blog post on how I used them).</p>

<p>These can then be executed locally using the <code>npm test</code> command and they are executed every time I push to GitHub by the Travis CI service, check out the results of the latest build <a href="https://travis-ci.org/matthewcodes/camel.js">here.</a></p>

<h1>Conclusion</h1>

<p>So far the framework is pretty basic, but with the testing framework now in place I can focus on adding new features. I plan to raise issues and milestones in GitHub to help track the progress to the initial 1.0 release. This will hopefully include most of the file component features and perhaps some http as well.</p>

<p>The code for <a href="https://github.com/matthewcodes/camel.js">camel.js is available on my GitHub</a>. Feel free to do a pull request and add some features!</p>


        <hr class="divider-short"/>

        
        <section>
          <h1>Comments</h1>
          <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
        </section>
        
      </div>
    </div>
  </div>
</article>

<hr class="divider-short"/>

<div class="archive-link">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        
          <a class="pull-left" href="/blog/2015/04/25/scrolling-animations-with-animate-dot-css-and-wow-dot-js/" title="Previous Post: Scrolling animations with Animate.css and WOW.js">&laquo; Previous: Scrolling animations with Animate.css and WOW.js</a>
        

        
          <a class="pull-right" href="/blog/2015/11/04/vagrant-and-hyper-v-issues/" title="Next Post: Vagrant and Hyper-V Issues">Next: Vagrant and Hyper-V Issues &raquo;</a>
        
      </div>
    </div>
  </div>
</div>

    <footer id="footer" class="her-row">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
  <a href="/"><h4>Home</h4></a>
</div>

<div class="col-md-2">
  <div class="social-icon-list">
    
    <a href="https://twitter.com/matt_codes"><img src="/images/glyphicons_social_31_twitter.png"/></a>
    

    
    <a href="https://github.com/matthewcodes"><img src="/images/glyphicons_social_21_github.png"/></a>
    

    

    
  </div>
</div>

<div class="pull-right">
  <h4>Powered by <a href="http://octopress.org/">Octopress</a>.</h4>
</div>


    </div>
  </div>
</footer>

    
      

<script type="text/javascript">
      var disqus_shortname = 'matthewcodes';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://matthewcodes.github.io/blog/2015/05/09/camel-dot-js-an-introduction/';
        var disqus_url = 'http://matthewcodes.github.io/blog/2015/05/09/camel-dot-js-an-introduction/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


    
  </body>
</html>
